@{
    Layout = null;
    ViewBag.Title = "<i class='fa fa-users '></i> Lista Pacientes";
    ViewBag.Titlenot = "Lista Pacientes";
}


<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">

    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="description" content="Sistema Resocentro" />
    <meta name="author" content="Resocentro" />
    <meta property="og:image" content="../images/logo/Logo_Azul.png">
    <meta property="og:image" content="../images/favicon.png">
    <title>Resocentro | Visor Sala Médica </title>


    <link href="~/js/jquery-ui/css/no-theme/jquery-ui-1.10.3.custom.min.css" rel="stylesheet" />
    <link rel="icon" type="image/png" href="../favicon.ico" />
    <meta content='width=device-width, initial-scale=1' name='viewport'>
    <link href="~/css/bootstrap.min.css" rel="stylesheet" />
    <link href="~/fonts/awesome/css/font-awesome.min.css" rel="stylesheet" />
    <script src="~/js/progressbar.js"></script>
    <!-- Theme style -->
    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
          <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
          <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
    <script src="~/js/jquery-1.11.0.min.js"></script>
    <script src="../js/ion.sound.min.js"></script>
    <script src="../js/bootstrap.min.js" type="text/javascript"></script>
    <script src="~/js/getUrl.js"></script>
    <!-- AdminLTE App -->
    <!-- AdminLTE for demo purposes -->

    <style type="text/css">
        .right-side {
            margin-left: 0 !important;
        }

        .edstado_2 {
            background-color: #faed5c;
        }

        .skin-black, .skin-black section, .skin-black .panesl-body,
        .table-bordered > tbody > tr > td {
            background: #091A38;
            color: #ffffff;
        }

        .table-bordered > tbody > tr > td {
            font-size: 38px;
        }

        .table-striped > tbody > tr:nth-child(odd) > td, .table-striped > tbody > tr:nth-child(odd) > th {
            background: #4a4848;
        }

        .table-bordered > thead > tr > th {
            background: #686464 !important;
            font-size: 15px;
            padding: 4px 8px 4px 8px;
        }

        .panel-heading {
            border-top-left-radius: 0px;
            border-top-right-radius: 0px;
        }

        .panel-primary > .panel-heading {
            color: #fff;
            background-color: #838C9B;
            border-color: #838C9B;
        }

        .bg-verde {
            background-color: #00A336 !important;
        }


        .panel-primary {
            border-color: #091A38;
            background: #091A38;
        }

        .panesl-body {
            border-color: #808080;
            margin-top: 10px;
            box-shadow: 0px 1px 3px rgba(255, 255, 255, 0.0);
        }

        .bg-green {
            background: #48DA28;
            color: #000;
        }

        .bg-celeste {
            background: #00B7FF !important;
            color: #000;
        }

        .bg-yellow {
            background: #E59400 !important;
            color: #000 !important;
        }

        .bg-plomo {
            background: #808183 !important;
            color: #000;
        }

        .bg-oscuro {
            background: #363A43 !important;
            color: #000;
        }

        .bg-blue {
            background: #1552C0;
            color: #FFF;
        }

        .bg-red {
            background: #C70E0E !important;
            color: #FFF;
        }

        .new-item {
            background: rgba(255, 255, 255, 0.6) !important;
            color: #000;
        }

        .subtitulo {
            color: rgba(255, 255, 255, 0.7);
        }
    </style>


    <script type="text/javascript">
        var parameter = "";
        var totalEncuesta, totalTecnologo, totalSupervisor, totalSatisfaccion, totalEquipo, totalPaciente;
        var muteEncuesta = true, muteTecnologo = false, muteSupervisor = true, muteSatisfaccion = true; muteEquipo = true, mutePaciente = true;
        var isMedicoVisible = true;
        var cambioautomatico;
        $(document).ready(function () {

            var _sede = $.get("sede");

            if (_sede != null)
                parameter = _sede;
            else {
                parameter = prompt("Ingrese el codigo de la sede", "101");
                window.location.assign(window.location.pathname + "?sede=" + parameter);
            }

            cargarPacientes();
            cambioMonitor();
            // setInterval(cambioMonitor, 10000);
            setInterval(cargarPacientes, 60000);



            $(window).resize(resizediv);
            cargartabla();
            cargarEquipos();
            efectosInfinite();
            setMute();
            setInterval(cargartabla, 30000);
            setInterval(cargarEquipos, 60000);
            ion.sound({
                sounds: [
                    { name: "equipo" },
                    { name: "tecnologo" },
                    { name: "encuesta" },
                    { name: "supervisor" },
                    { name: "satisfaccion" }
                ],
                path: "../sound/",
                preload: true,
                volume: 1.0
            });
        });
        function cambioMonitorAuto() {
            var ischeck = $('#chkChange').prop('checked')
            
            if (ischeck) {
                if (cambioautomatico == undefined)
                    cambioautomatico = setInterval(function () {
                        cambioMonitor();
                    }, 5000);
            } else {
                if (cambioautomatico != undefined) {
                    clearInterval(cambioautomatico);
                    cambioautomatico = undefined;
                }
            }
        }
        function cambioMonitor() {
            if (isMedicoVisible) {
                $("#listaPaciente").hide()
                $("#listaMedico").show()
                $("#span_titulo").html("Lista Área Médica");
                isMedicoVisible = false;
            } else {
                $("#listaPaciente").show()
                $("#listaMedico").hide()
                $("#span_titulo").html("Lista Área Tecnólogo");
                isMedicoVisible = true;
            }
            //put bottom footer
            resizediv();
        }

        function cargarPacientes() {
            if (parameter != "") {
                //Carga Paciente
                $.ajax({
                    url: "@Url.Action("getListCarga", "Notificaciones")",
                    data: { sede: parameter, total: totalPaciente },
                    dataType: "json",
                    type: "POST",
                    error: function () {
                        $("#div_paciente").html("<code>Hubo un error al momento de Actualizar</code>");

                    },
                    success: function (data) {
                        $("#div_paciente").html(data.resultado);
                        totalPaciente = data.total
                        if (muteEquipo && data.alarm) {
                            ion.sound.play("equipo");
                        }
                        efecto("div_paciente");
                        progressbarPaciente()
                    }
                });

            } else {
                $("#div-div_equipo").html("<code>No se identifico la Sede</code>");
            }
        }
        function cargarEquipos() {
            if (parameter != "") {
                //Carga Equipo
                $.ajax({
                    url: "@Url.Action("getCargaEquipo", "Notificaciones")",
                    data: { sede: parameter, total: totalEquipo },
                    dataType: "json",
                    type: "POST",
                    error: function () {
                        $("#div_equipo").html("<code>Hubo un error al momento de Actualizar</code>");

                    },
                    success: function (data) {
                        $("#div_equipo").html(data.resultado);
                        totalEquipo = data.total
                        if (muteEquipo && data.alarm) {
                            ion.sound.play("equipo");
                        }
                        efecto("div_equipo");
                    }
                });
                progressbarBottom()
            } else {
                $("#div-div_equipo").html("<code>No se identifico la Sede</code>");
            }
        }

        function cargartabla() {

            if (parameter != "") {
                //Encuesta
                $.ajax({
                    url: "@Url.Action("getlistEncuesta", "Notificaciones")",
                    data: { sede: parameter, total: totalEncuesta },
                    dataType: "json",
                    type: "POST",
                    error: function () {
                        $("#div_encuesta").html("<code>Hubo un error al momento de Actualizar</code>");

                    },
                    success: function (data) {
                        $("#div_encuesta").html(data.resultado);
                        totalEncuesta = data.total;
                        if (muteEncuesta && data.alarm) {
                            ion.sound.play("encuesta");
                        }
                        efecto("div_encuesta");
                    }
                });
                //Tecnologo
                $.ajax({
                    url: "@Url.Action("getlistTecnologo", "Notificaciones")",
                    data: { sede: parameter, total: totalTecnologo },
                    dataType: "json",
                    type: "POST",
                    error: function () {
                        $("#div_tecnologo").html("<code>Hubo un error al momento de Actualizar</code>");

                    },
                    success: function (data) {
                        $("#div_tecnologo").html(data.resultado);
                        totalTecnologo = data.total;
                        if (muteTecnologo && data.alarm)
                            ion.sound.play("tecnologo");
                        efecto("div_tecnologo");
                    }
                });
                //Supervisor
                $.ajax({
                    url: "@Url.Action("getlistSupervisor", "Notificaciones")",
                    data: { sede: parameter, total: totalSupervisor },
                    dataType: "json",
                    type: "POST",
                    error: function () {
                        $("#div_supervisor").html("<code>Hubo un error al momento de Actualizar</code>");

                    },
                    success: function (data) {
                        $("#div_supervisor").html(data.resultado);
                        totalSupervisor = data.total;
                        if (muteSupervisor && data.alarm) {
                            ion.sound.play("supervisor");
                        }
                        efecto("div_supervisor");
                    }
                });
                //Satisfacción
                $.ajax({
                    url: "@Url.Action("getlistSatisfaccion", "Notificaciones")",
                    data: { sede: parameter, total: totalSatisfaccion },
                    dataType: "json",
                    type: "POST",
                    error: function () {
                        $("#div_satisfaccion").html("<code>Hubo un error al momento de Actualizar</code>");

                    },
                    success: function (data) {
                        $("#div_satisfaccion").html(data.resultado);
                        totalSatisfaccion = data.total;
                        if (muteSatisfaccion && data.alarm) {
                            ion.sound.play("satisfaccion");
                        }
                        efecto("div_satisfaccion");
                    }
                });
                progressbar();

            } else {
                $("#div-lista").html("<code>No se identifico la Sede</code>");
            }

        }
        function progressbar() {
            $('#progresbar').html("");
            var line = new ProgressBar.Line('#progresbar', {
                color: '#06A7FA',
                duration: 30000,
                strokeWidth: 0.3,

            });
            line.animate(1, function () {
                line.animate(0);
            })

        }

        function progressbarBottom() {
            $('#progresbar1').html("");
            var line1 = new ProgressBar.Line('#progresbar1', {
                color: '#06A7FA',
                duration: 60000,
                strokeWidth: 0.3,

            });
            line1.animate(1, function () {
                line1.animate(0);
            })
        }
        function progressbarPaciente() {
            $('#progresbarPaciente').html("");
            var line1 = new ProgressBar.Line('#progresbarPaciente', {
                color: '#06A7FA',
                duration: 60000,
                strokeWidth: 0.3,

            });
            line1.animate(1, function () {
                line1.animate(0);
            })
        }
        function efectosInfinite() {
            setInterval(function () {
                alertar();
            }, 1500);
            function alertar() {
                $("#div-lista .bg-red").each(function () {
                    $(this).fadeTo(500, 0.5).fadeTo(500, 1.0)
                });
            }
        }
        function efecto(div) {
            $("#" + div + "  .bg-yellow").each(function () {
                $(this).fadeTo(700, 0.5).fadeTo(700, 1.0)
            });
            $("#" + div + " .new-item").each(function () {
                $(this).fadeTo(1000, 0.5).fadeTo(1000, 1.0)
            });
            $("#" + div + " .parpadeo").each(function () {
                $(this).fadeTo(900, 0.5).fadeTo(900, 1.0)
                $(this).fadeTo(900, 0.5).fadeTo(900, 1.0)
                $(this).fadeTo(900, 0.5).fadeTo(900, 1.0)
            });

        }
        function resizediv() {
            $("#lst_equipo").css({ top: ($(window).height() /*- $("#div-lista").height()-400*/ - $("footer").height()) });
        }
        function setMute(tipo) {
            if (tipo == 0)
                muteEncuesta = !muteEncuesta;
            if (tipo == 1)
                muteTecnologo = !muteTecnologo;

            if (tipo == 2)
                muteSupervisor = !muteSupervisor;

            if (tipo == 3)
                muteSatisfaccion = !muteSatisfaccion;
            if (tipo == 4)
                muteEquipo = !muteEquipo;

            if (tipo == 5)
                mutePaciente = !mutePaciente;

            if (mutePaciente)
                $("#btn-paciente").html("<i class='fa fa-volume-up fa-lg'></i>")
            else
                $("#btn-paciente").html("<i class='fa fa-volume-off fa-lg'></i>")

            if (muteEncuesta)
                $("#btn-encuesta").html("<i class='fa fa-volume-up fa-lg'></i>")
            else
                $("#btn-encuesta").html("<i class='fa fa-volume-off fa-lg'></i>")
            if (muteTecnologo)
                $("#btn-tecnologo").html("<i class='fa fa-volume-up fa-lg'></i>")
            else
                $("#btn-tecnologo").html("<i class='fa fa-volume-off fa-lg'></i>")
            if (muteSupervisor)
                $("#btn-supervisor").html("<i class='fa fa-volume-up fa-lg'></i>")
            else
                $("#btn-supervisor").html("<i class='fa fa-volume-off fa-lg'></i>")

            if (muteSatisfaccion)
                $("#btn-satisfaccion").html("<i class='fa fa-volume-up fa-lg'></i>")
            else
                $("#btn-satisfaccion").html("<i class='fa fa-volume-off fa-lg'></i>")
            if (muteEquipo)
                $("#btn-equipo").html("<i class='fa fa-volume-up fa-lg'></i>")
            else
                $("#btn-equipo").html("<i class='fa fa-volume-off fa-lg'></i>")

        }
    </script>
    <style>
        .col-md-3 {
            padding: 0 5px !important;
        }

        .triangulo_inf {
            width: 0;
            margin: 0 auto;
            height: 2px;
            border-left: 15px solid transparent;
            border-right: 15px solid transparent;
            border-top: 10px solid #838C9B;
        }

        .triangulo_sup {
            width: 0;
            margin: 0 auto;
            height: 2px;
            border-left: 15px solid transparent;
            border-right: 15px solid transparent;
            border-bottom: 10px solid #838C9B;
        }

        .progress-bar-lista {
            width: 100%;
            top: -7px;
            position: relative;
            z-index: 9999;
        }

        .progress-bar-bottom {
            width: 100%;
            bottom: 0px;
            position: absolute;
            z-index: 9999;
        }

        .col-md-x {
            margin: 0 5px;
            width: 20%;
        }

        .div-cant {
            border-radius: 100%;
            border: 7px solid #FFF;
            margin: 0 auto 10px auto;
            width: 190px;
            height: 190px;
            line-height: 1.9;
        }
    </style>
</head>
<body class="skin-black">
    <input type="checkbox" id="chkChange" onchange="cambioMonitorAuto()" />  <button class="btn btn-info btn-xs" onclick="cambioMonitor()"><i class="fa fa-exchange"></i></button> <span id="span_titulo"></span>
    <div id="listaMedico">
        <div class="row" id="div-lista" style="padding:0px;margin:0px">
            <div class="progress-bar-lista" id="progresbar">

            </div>
            <div class="col-md-12" style="padding:0px;margin:0px;top:-13px;">

                <div class="col-md-3" style="font-size:medium;">
                    <div class="panel panel-primary" style="margin-bottom:10px;">
                        <div class="panel-heading">
                            <h1 class="panel-title" style="font-size: 30px;text-align:center;">ENCUESTA <button type="button" onclick="setMute(0)" class=" pull-right btn btn-default " id="btn-encuesta"></button> </h1>
                        </div>
                        <div class="triangulo_inf"></div>
                    </div>
                    <div id="div_encuesta">

                    </div>
                </div>
                <div class="col-md-3" style="font-size:medium;">
                    <div class="panel panel-primary" style="margin-bottom:10px;">
                        <div class="panel-heading">
                            <h1 class="panel-title" style="font-size: 30px;text-align:center;">ADQUISICIÓN <button type="button" onclick="setMute(1)" class=" pull-right btn btn-default " id="btn-tecnologo"></button></h1>
                        </div>
                        <div class="triangulo_inf "></div>
                    </div>
                    <div id="div_tecnologo">
                    </div>
                </div>
                <div class="col-md-3" style="font-size:medium;">
                    <div class="panel panel-primary" style="margin-bottom:10px;">
                        <div class="panel-heading">
                            <h1 class="panel-title" style="font-size: 30px;text-align:center;">SUPERVISIÓN <button type="button" onclick="setMute(2)" class=" pull-right btn btn-default " id="btn-supervisor"></button></h1>
                        </div>
                        <div class="triangulo_inf"></div>
                    </div>
                    <div id="div_supervisor">
                    </div>
                </div>
                <div class="col-md-3" style="font-size:medium;">
                    <div class="panel panel-primary" style="margin-bottom:10px;">
                        <div class="panel-heading">
                            <h1 class="panel-title" style="font-size: 30px;text-align:center;">DESPEDIDA <button type="button" onclick="setMute(3)" class=" pull-right btn btn-default " id="btn-satisfaccion"></button></h1>
                        </div>
                        <div class="triangulo_inf"></div>
                    </div>
                    <div id="div_satisfaccion">
                    </div>
                </div>
            </div>

            @*<div class="col-md-12 " style="padding:0px;margin:0px;text-align:center;color:#828B9C;font-size:20px;">
                    <i class="fa fa-users fa-lg"></i> Atendiendo ahora &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                    <i class="fa fa-user fa-lg"></i> Próximo a ser atendido &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                    <i class="fa fa-clock-o fa-lg"></i> En Espera
                </div>*@
        </div>

        <footer id="lst_equipo" style="position:absolute;  width: 100%;">
            <div class="row " style="padding:0px;margin:0px">
                <button type="button" onclick="setMute(4)" class=" pull-right btn btn-default " id="btn-equipo"></button>
                <div id="div_equipo" class="" style="width:100%; display: inline-flex;padding:0px;margin:0px">

                </div>

            </div>



        </footer><div class="progress-bar-bottom" id="progresbar1"></div>
    </div>
    <div id="listaPaciente">
        <div class="row" id="div-lista" style="padding:0px;margin:0px;position: relative;">
            <div class="progress-bar-lista" id="progresbarPaciente">
            </div>
            <div id="div_paciente" class="" style="width:100%;display: inline-flex;padding:0px;margin:0px;top:7px;position:absolute">
            </div>
        </div>
    </div>

</body>

</html>
