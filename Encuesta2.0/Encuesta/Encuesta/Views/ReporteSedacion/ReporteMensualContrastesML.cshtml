@model Encuesta.ViewModels.Reporte.DataReporteMensualMLContraste
           @{
    ViewBag.Title = "<i class='fa fa-area-chart fa-lg'></i> Reporte Mensual de Contrastes - ML ";
    ViewBag.Titlenot = "Reporte Mensual de Contrastes - ML";
}

@*<link href="http://netdna.bootstrapcdn.com/font-awesome/3.1.1/css/font-awesome.min.css" rel="stylesheet">
    <link href="http://cdnjs.cloudflare.com/ajax/libs/x-editable/1.4.4/bootstrap-editable/css/bootstrap-editable.css" rel="stylesheet">
    <link href="https://www.datatables.net/release-datatables/media/css/jquery.dataTables.css" rel="stylesheet">
    <link href="https://www.datatables.net/release-datatables/extensions/TableTools/css/dataTables.tableTools.css" rel="stylesheet">
    <link href="lib/bootstrap-filterable.css" rel="stylesheet" type="text/css">
    <script src="~/js/plugins/jquery.js"></script>
    <script src="~/js/plugins/dataTables/jquery.dataTables.js"></script>
    <script src="~/js/plugins/dataTables/dataTables.bootstrap.js"></script>
    <script src="~/js/plugins/dataTables/dataTables.tableTools.js"></script>*@

<script src="~/js/plugins/dataTables/buttons.print.min.js"></script>
<script src="~/js/plugins/dataTables/jquery-1.12.0.min.js"></script>
<script src="~/js/plugins/dataTables/dataTables.buttons.min.js"></script>
<script src="~/js/plugins/dataTables/jquery.dataTables.min.js"></script>
<link href="https://cdn.datatables.net/1.10.11/css/jquery.dataTables.min.css" rel="stylesheet">
<link href="https://cdn.datatables.net/buttons/1.1.2/css/buttons.dataTables.min.css" rel="stylesheet">
<script src="https://cdn.datatables.net/tabletools/2.2.4/js/dataTables.tableTools.min.js">
</script>
<link rel="stylesheet" type="text/css"
      href="https://cdn.datatables.net/tabletools/2.2.4/css/dataTables.tableTools.css" />




@*<link rel="stylesheet" type="text/css" media="print" href="mystyle.css">*@
@*<link rel="stylesheet" href="print-style.css" type="text/css" media="print" />*@

@*<style type="text/css">
    @@import url(print-style.css) print;
    </style>*@

<script type="text/javascript">
    $(document).ready(function () {
        //$('#table_mensual').dataTable();

        load_sedes();

            //$('#table_reporte').dataTable();

            //$('#table_resumen').dataTable();
            function exportTableToCSV1($table, filename,cabecera) {

                var $rows = $table.find('tr:has(td)'),
                    // Temporary delimiter characters unlikely to be typed by keyboard
                    // This is to avoid accidentally splitting the actual contents
                    tmpColDelim = String.fromCharCode(11), // vertical tab character
                    tmpRowDelim = String.fromCharCode(0), // null character

                    // actual delimiter characters for CSV format
                    colDelim = '","',
                    rowDelim = '"\r\n"',         

                    // Grab text from table into CSV formatted string
                    csv = cabecera + $rows.map(function (i, row) {
                        var $row = $(row),
                            $cols = $row.find('td');

                        return $cols.map(function (j, col) {
                            var $col = $(col),
                                text = $col.text();

                            return text.replace(/"/g, '""'); // escape double quotes

                        }).get().join(tmpColDelim);

                    }).get().join(tmpRowDelim)
                        .split(tmpRowDelim).join(rowDelim)
                        .split(tmpColDelim).join(colDelim) + '"',

                    // Data URI

                     csvData = 'data:application/csv;charset=utf-8,' + encodeURIComponent(csv);

                $(this)
                        .attr({
                            'download': filename,
                            'href': csvData,
                            'target': '_blank'
                        });

            }
            $("#btnExportDetalle").on('click', function (event) {
                // CSV
                exportTableToCSV1.apply(this, [$('#table_mensual'), 'Reporte_Mensual_Contraste_ML.csv', '"\"CONTRASTE\,"\"MES\,"\"DIA 1\,"\"DIA 2\,"\"DIA 3\,"\"DIA 4\,"\"DIA 5\,"\"DIA 6\,"\"DIA 7\,"\"DIA 8\,"\"DIA 9\,"\"DIA 10\,"\"DIA 11\,"\"DIA 12\,"\"DIA 13\,"\"DIA 14,"\"DIA 15,"\"DIA 16,"\"DIA 17,"\"DIA 18,"\"DIA 19,"\"DIA 20,"\"DIA 21,"\"DIA 22,"\"DIA 23,"\"DIA 24,"\"DIA 25,"\"DIA 26,"\"DIA 27,"\"DIA 28,"\"DIA 29,"\"DIA 30,"\"DIA 31' + '\r\n"']);

            });

        function load_sedes() {
            $.get(
                  '@Url.Action("getsedes", "Reporte")'
               )
              .done(function (data) {
                  $.each(data, function (i, row) {
                      var $option = $('<option>');
                      $option.val(row.codigosucursal);
                      $option.html(row.descripcion);
                      $('#lstsedes').append($option);
                  })
              })
              .fail(function (data) {
                  console.log('error !!!');
              }
          );
        }
    });

    //$(document).ready(function () {

    //    $('#table_frascos').DataTable({
    //        "autoWidth": true,
    //        "sDom": 'T<"clear">lfrtip',
    //        "oTableTools": {
    //            "sSwfPath": "https://datatables.net/release-datatables/extras/TableTools/media/swf/copy_csv_xls_pdf.swf",
    //            "aButtons": [
    //                {
    //                    "sExtends": "print",
    //                    "bShowAll": true,
    //                    "sInfo": "<br><center><h1>PRESIONAR CTRL + P - PARA IMPRIMIR</h1></center><br><br><center><h3>PRESIONAR ESCAPE AL TERMINAR</h3></center>",
    //                    "sButtonText": "Imprimir",
    //                    "sToolTip": "Click para Imprimir",
    //                    "sMessage": "<center><h1><b>REPORTE CONTRASTE - FRASCOS</h1></center>",

    //                    //                            "mColumns": [{ "width": "10%" }, null,
    //                    //null,
    //                    //null,
    //                    //null]
    //                }
    //            ]

    //        }
    //    });
    //});

</script>

    <div class="row">
        <div class="col-lg-6">
            <div class="panel panel-default">
                <div class="panel-heading">
                    Filtros
                </div>
                <div class="panel-body">


    @using (Html.BeginForm("ReporteMensualContrastesML", "Reporte", FormMethod.Get))
                {
        <script type="text/javascript">

            function validar() {
                var msj = "";
                if ($("#i").val() == "")
                    msj += "- Seleccione Mes \n";
                if ($("#lstsedes").val() == "")
                    msj += "- Seleccione Sede \n";
                if (msj == "")
                    return true;
                else {
                    alert(msj);
                    return false;
                }
            }
        </script>

        <div class="form-group col-lg-6">
            <label>Mes:</label>
            @*<input type="date" id="i" name="i" class="form-control" />*@
            <select id="i" name="i" class="form-control">

                <option value="1">Enero</option>

                <option value="2">Febrero</option>

                <option value="3">Marzo</option>

                <option value="4">Abril</option>

                <option value="5">Mayo</option>

                <option value="6">Junio</option>

                <option value="7">Julio</option>

                <option value="8">Agosto</option>

                <option value="9">Septiembre</option>

                <option value="10">Octubre</option>

                <option value="11">Noviembre</option>

                <option value="12">Diciembre</option>

            </select>
</div>


        <div class="form-group col-lg-6">
            <label>Sedes</label>
            <select id="lstsedes" name="lstsedes" class="form-control">
                <option value="">--- Seleccione ---</option>
            </select>
        </div>

        
            <input type="submit" value="Buscar" onclick="return validar();" class="btn btn-outline btn-success" />
                }
            </div>

        </div>
            </div>

</div>

<div class="row">
    <div class="col-sm-12">
        <div class="panel panel-primary">
            <div class="panel-heading">
                Reporte Mensual de Contrastes - ML
                <a href="#" id="btnExportDetalle" class="btn btn-primary pull-right">Exportar a Excel</a>
            </div>
                @*<div class="panel-group" id="accordion">
                    @foreach (var item in Model.frasco.Select(x => new { x.insumoid,x.nombre }).Distinct().ToList())
                    {*@


                @*<div class="panel panel-info">
                    <div class="panel-heading">
                        <h4 class="panel-title">
                            <a data-toggle="collapse" data-parent="#accordion" href="#collapse_@item.insumoid">Contraste @item.nombre</a>
                        </h4>
                    </div>
                    <div id="collapse_@item.insumoid" class="panel-collapse collapse">*@

                @*<div class="panel-body">
                    <div class="panel panel-primary">*@

                        <div class="panel-body">
                            <div class="row">
                                <div class="col-md-11">
                                    <table id="table_mensual" class="table table-striped table-bordered table-hover " style="font-family:Arial;font-size:11px;" width="120">
                                        <thead>
                                            <tr>
                                                <th style="text-align:center" width="20px" >
                                                    CONTRASTE
                                                </th>

                                                <th style="text-align:center" width="13px">
                                                    MES
                                                </th>

                                                <th style="text-align:center" width="4px">
                                                    1
                                                </th>

                                                <th style="text-align:center" width="4px">
                                                    2
                                                </th>

                                                <th style="text-align:center" width="4px">
                                                    3
                                                </th>

                                                <th style="text-align:center" width="4px">
                                                    4
                                                </th>

                                                <th style="text-align:center" width="4px">
                                                    5
                                                </th>

                                                <th style="text-align:center" width="4px">
                                                    6
                                                </th>

                                                <th style="text-align:center" width="4px">
                                                    7
                                                </th>

                                                <th style="text-align:center" width="4px">
                                                    8
                                                </th>

                                                <th style="text-align:center" width="4px">
                                                    9
                                                </th>

                                                <th style="text-align:center" width="4px">
                                                    10
                                                </th>

                                                <th style="text-align:center" width="4px">
                                                    11
                                                </th>

                                                <th style="text-align:center" width="4px">
                                                    12
                                                </th>

                                                <th style="text-align:center" width="4px">
                                                    13
                                                </th>

                                                <th style="text-align:center" width="4px">
                                                    14
                                                </th>

                                                <th style="text-align:center" width="4px">
                                                    15
                                                </th>

                                                <th style="text-align:center" width="4px">
                                                    16
                                                </th>

                                                <th style="text-align:center" width="4px">
                                                    17
                                                </th>

                                                <th style="text-align:center" width="4px">
                                                    18
                                                </th>

                                                <th style="text-align:center" width="4px">
                                                    19
                                                </th>

                                                <th style="text-align:center" width="4px">
                                                    20
                                                </th>

                                                <th style="text-align:center" width="4px">
                                                    21
                                                </th>

                                                <th style="text-align:center" width="4px">
                                                    22
                                                </th>

                                                <th style="text-align:center" width="4px">
                                                    23
                                                </th>

                                                <th style="text-align:center" width="4px">
                                                    24
                                                </th>

                                                <th style="text-align:center" width="4px">
                                                    25
                                                </th>

                                                <th style="text-align:center" width="4px">
                                                    26
                                                </th>

                                                <th style="text-align:center" width="4px">
                                                    27
                                                </th>

                                                <th style="text-align:center" width="4px">
                                                    28
                                                </th>

                                                <th style="text-align:center" width="4px">
                                                    29
                                                </th>

                                                <th style="text-align:center" width="4px">
                                                    30
                                                </th>

                                                <th style="text-align:center" width="4px">
                                                    31
                                                </th>

                                                <th style="text-align:center" width="7px">
                                                    TOTAL
                                                </th>
                                            </tr>
                                        </thead>
                                        @*.Where(x => x.insumoid == item.insumoid).ToList())*@
                                        <tbody>
                                            @foreach (var item1 in Model.mensual)
                                            {
                                                <tr>
                                                    <td style="text-align:center">@item1.nom_contraste</td>
                                                    <td style="text-align:center">@item1.mes</td>
                                                    <td style="text-align:center">@item1.dia1</td>
                                                    <td style="text-align:center">@item1.dia2</td>
                                                    <td style="text-align:center">@item1.dia3</td>
                                                    <td style="text-align:center">@item1.dia4</td>
                                                    <td style="text-align:center">@item1.dia5</td>
                                                    <td style="text-align:center">@item1.dia6</td>
                                                    <td style="text-align:center">@item1.dia7</td>
                                                    <td style="text-align:center">@item1.dia8</td>
                                                    <td style="text-align:center">@item1.dia9</td>
                                                    <td style="text-align:center">@item1.dia10</td>
                                                    <td style="text-align:center">@item1.dia11</td>
                                                    <td style="text-align:center">@item1.dia12</td>
                                                    <td style="text-align:center">@item1.dia13</td>
                                                    <td style="text-align:center">@item1.dia14</td>
                                                    <td style="text-align:center">@item1.dia15</td>
                                                    <td style="text-align:center">@item1.dia16</td>
                                                    <td style="text-align:center">@item1.dia17</td>
                                                    <td style="text-align:center">@item1.dia18</td>
                                                    <td style="text-align:center">@item1.dia19</td>
                                                    <td style="text-align:center">@item1.dia20</td>
                                                    <td style="text-align:center">@item1.dia21</td>
                                                    <td style="text-align:center">@item1.dia22</td>
                                                    <td style="text-align:center">@item1.dia23</td>
                                                    <td style="text-align:center">@item1.dia24</td>
                                                    <td style="text-align:center">@item1.dia25</td>
                                                    <td style="text-align:center">@item1.dia26</td>
                                                    <td style="text-align:center">@item1.dia27</td>
                                                    <td style="text-align:center">@item1.dia28</td>
                                                    <td style="text-align:center">@item1.dia29</td>
                                                    <td style="text-align:center">@item1.dia30</td>
                                                    <td style="text-align:center">@item1.dia31</td>
                                                    <td style="text-align:center">@item1.total</td>
                                                </tr>
                                            }
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                    </div>

                </div>
                @*</div>
                    </div>*@
                @*}
                    </div>*@
            </div>
        </div>
