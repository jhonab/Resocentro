@{
    ViewBag.Title = "<i class='fa fa-gear '></i> Herramientas";
    ViewBag.Titlenot = "Herramientas";
}
<script src="~/js/jquery-ui.min.js"></script>
<script type="text/javascript">
    $(document).ready(function () {
        $("#msj").hide()//ocultar el msj
        ocultarListas();
    });
    function ocultarListas() {
        $("#div_partial_encuesta").hide();
    }
    function cargarEncuesta(div, examen) {
        $("#div_partial_encuesta").show();
         if (examen != "" && examen > 0) {
            $.ajax({
                url: "@Url.Action("GetEncuesta", "Herramientas")",
                data: { examen: examen },
                dataType: "json",
                type: "POST",
                error: function () {
                    mostrarmensaje(4, 'Error al mostrar los cambios realizados');
                },
                success: function (data) {
                    if (data.result) {
                        $(div).html(data.msj);
                    } else {
                        mostrarmensaje(2, "No existe ninguna referencia con el numero ingresado");
                    }

                }
            });

        } else
            mostrarmensaje(4, "Ingrese un numero de Examen correcto");
    }

    function cambiarEncuesta() {
        var examnew = $("#num_exam_new").val();
        var examold = $("#num_exam_old").val();
        if (examold != "" && examnew != "" &&(examnew!=examold)) {
            $.ajax({
                url: "@Url.Action("CambioEncuesta", "Herramientas")",
                data: { examenold: examold, examennew: examnew },
                dataType: "json",
                type: "POST",
                error: function () {
                    mostrarmensaje(4, "Ocurrio un error con el procesamiento, vuelva a interntarlo");
                },
                success: function (data) {
                    if (data.result) {
                        mostrarmensaje(1, "Se realizo el cambio");
                        cargarEncuesta('#partial_encuesta', examold);
                        cargarEncuesta('#partial_cambio', examnew);
                    }
                    else
                        mostrarmensaje(4, data.msj);
                }
            });
        }
        else
            mostrarmensaje(4, "Ingrese el N° Examen correcto");

    }
   

</script>

<div class="row">
    <div class="col-lg-12">
        <div class="box box-primary">
            <div class="box-header">
                <h2 class="box-title">Mover Encuesta </h2>
            </div>
            <div class="box-body chart-responsive">

                @using (Html.BeginForm())
                {
                    @Html.AntiForgeryToken()
                    @Html.ValidationSummary(true)
                    <div class="row">

                        <div class="alert" id="msj">
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-lg-3">
                            <div class="form-group">
                                <label>N° Examen (Antiguo):</label>
                                <input type="number" id="num_exam_old" placeholder="Número de Examen (Antiguo)" class="form-control" />
                            </div>
                        </div>

                        <div class="col-lg-3">
                            <div class="form-group">
                                <label>N° Examen (Nuevo):</label>
                                <input type="number" id="num_exam_new" placeholder="Número de Examen (Nuevo)" class="form-control" />
                            </div>
                        </div>
                        <div class="col-lg-1">
                            <div class="form-group">
                                <label></label>
                                <button type="button" class=" btn btn-danger " onclick="cambiarEncuesta()"><i class="fa fa-exchange"></i>&nbsp;&nbsp;Mover</button>

                            </div>
                        </div>
                    </div>
                    <div id="div_partial_encuesta">
                        <div class="row">
                            <div class="col-lg-4">
                                 <label>Encuesta Antigua</label>
                                <div id="partial_encuesta">
                                </div>
                            </div>
                        </div>
                        <div class="row" id="div_partial_Cambio">
                            <div class="col-lg-4">
                                 <label>Encuesta Nueva</label>
                                <div id="partial_cambio">
                                </div>
                            </div>
                        </div>
                    </div>               
                }

            </div>
        </div>
    </div>
</div>
