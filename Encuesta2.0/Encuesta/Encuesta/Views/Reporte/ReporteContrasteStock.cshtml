@model IEnumerable<Encuesta.ViewModels.Reporte.Reporte_Contraste>
@{
    ViewBag.Title = "<i class='fa fa-area-chart fa-lg'></i> Imprimir - Reporte Contraste";
    ViewBag.Titlenot = "Contrastes Usados";
}

<script src="~/js/plugins/dataTables/jquery.dataTables.min.js"></script>
<link href="https://cdn.datatables.net/1.10.11/css/jquery.dataTables.min.css" rel="stylesheet">
<script src="https://cdn.datatables.net/tabletools/2.2.4/js/dataTables.tableTools.min.js">
</script>
<link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/tabletools/2.2.4/css/dataTables.tableTools.css" />


<script type="text/javascript">

    $(function () {
        function exportTableToCSV1($table, filename, cabecera) {

            var $rows = $table.find('tr:has(td)'),
                // Temporary delimiter characters unlikely to be typed by keyboard
                // This is to avoid accidentally splitting the actual contents
                tmpColDelim = String.fromCharCode(11), // vertical tab character
                tmpRowDelim = String.fromCharCode(0), // null character

                // actual delimiter characters for CSV format
                colDelim = '","',
                rowDelim = '"\r\n"',

                // Grab text from table into CSV formatted string
                csv = cabecera + $rows.map(function (i, row) {
                    var $row = $(row),
                        $cols = $row.find('td');

                    return $cols.map(function (j, col) {
                        var $col = $(col),
                            text = $col.text();

                        return text.replace(/"/g, '""'); // escape double quotes

                    }).get().join(tmpColDelim);

                }).get().join(tmpRowDelim)
                    .split(tmpRowDelim).join(rowDelim)
                    .split(tmpColDelim).join(colDelim) + '"',

                // Data URI

                 csvData = 'data:application/csv;charset=utf-8,' + encodeURIComponent(csv);

            $(this)
                    .attr({
                        'download': filename,
                        'href': csvData,
                        'target': '_blank'
                    });

        }
        $("#btnExportDetalle").on('click', function (event) {
            // CSV
            exportTableToCSV1.apply(this, [$('#table_reporte'), 'detalle.csv', '"\"Sede\,"\"Insumo\,"\"#\,"\"Usado\,"\"Merma' + '\r\n"']);

        });
    });

</script>

<div class="row">
    <div class="col-sm-12">
        <div class="panel panel-primary">
            <div class="panel-heading">
                Reporte Contraste
                <a href="#" id="btnExportDetalle" class="btn btn-primary pull-right">Export Detalle</a>
            </div>

            <div class="panel-body">
                <div class="row">
                    <div class="col-md-11">
                        <table id="table_reporte" class="table table-striped table-bordered table-hover " width="107">
                            <thead>
                                <tr>
                                    <th width="8" height="5">
                                        Sede
                                    </th>
                                    <th width="8" height="5">
                                        Insumo
                                    </th>
                                    <th width="8" height="5">
                                        #
                                    </th>
                                    <th width="8" height="5">
                                        Usado
                                    </th>
                                    <th width="10">
                                        Queda
                                    </th>

                                </tr>
                            </thead>
                            <tbody>
                                @foreach (var item in Model)
                                {
                                    <tr>
                                        <td width="8" height="5">@item.sede</td>
                                        <td width="8" height="5">@item.producto</td>
                                        <td width="8" height="5">@item.lote </td>
                                        <td width="8" height="5">@item.usado </td>
                                        <td width="auto" height="5">@item.merma </td>
                                    </tr>
                                }
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>


